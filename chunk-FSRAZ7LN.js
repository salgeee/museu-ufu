import{a as pe,c as me}from"./chunk-QZTJJTMP.js";import{b as Se}from"./chunk-AWTJTHLI.js";import{n as fe}from"./chunk-TTLS563I.js";import{a as J}from"./chunk-FVM4AV5G.js";import{Bb as ce,Ga as ae,Ja as ne,Ka as k,La as le,Na as y,Rc as z,a as H,cc as oe,f as ie,ha as x,ka as G,l as q,na as E,pa as se,rb as he,ua as re,wc as ue,ya as Z}from"./chunk-PJL2AZYT.js";var j=function(h){return h.COORDINATOR="COORDINATOR",h.STUDENT="STUDENT",h.PUBLIC="PUBLIC",h}(j||{});var be=(()=>{class h{_alert=new q;_clear=new q;get alertEvents$(){return this._alert.asObservable()}set alertEvents(t){this._alert.next(t)}get clearEvent$(){return this._clear.asObservable()}showAlert(t,e,a,s=!0,l=4e3,o=!0,n=0){n?setTimeout(()=>{this.alertEvents={type:t,message:e,title:a,duration:l,autoClose:s,closable:o}},n):this.alertEvents={type:t,message:e,title:a,duration:l,autoClose:s,closable:o}}clearAlerts(){this._clear.next()}static \u0275fac=function(e){return new(e||h)};static \u0275prov=x({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})();var L=class{ourStorage;constructor(){}setItem(p,t){typeof t=="string"?this.ourStorage.setItem(p,t):this.ourStorage.setItem(p,JSON.stringify(t))}getItem(p){return this.ourStorage.getItem(p)}getParseItem(p){let t=this.getItem(p);return t?JSON.parse(t):null}removeItem(p){this.ourStorage.removeItem(p)}hasItem(p){return this.ourStorage.hasOwnProperty(p)}clear(){this.ourStorage.clear()}};var de=(()=>{class h extends L{ourStorage=localStorage;static \u0275fac=(()=>{let t;return function(a){return(t||(t=Z(h)))(a||h)}})();static \u0275prov=x({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})();var X="credentials",qe=(()=>{class h{localStorage=E(de);router=E(fe);credentials=y(null);credentials$=Se(this.credentials);isStudent=z(()=>this.credentials()?.role===j.STUDENT);isPublic=z(()=>!this.credentials()||this.credentials()?.role===j.PUBLIC);constructor(){this.credentials.set(this.localStorage.getParseItem(X))}setCredentials(t){this.credentials.set(t),this.localStorage.setItem(X,t)}logout(t=!0){this.credentials.set(null),this.localStorage.removeItem(X),t&&this.router.navigate(["/login"])}get isAuthenticated(){return!!this.credentials()?.accessToken}canActivate(){return this.isAuthenticated||this.router.navigate(["/login"]),this.isAuthenticated}canActivateByRole(t){return!this.isAuthenticated||this.credentials()?.role!==t?(this.router.navigate(["/login"]),!1):!0}static \u0275fac=function(e){return new(e||h)};static \u0275prov=x({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})();var ee=class{constructor(p,t){this.name=p,this.component=t,this._currentFocus=-1,this._setBehavior()}_setBehavior(){this._setPasswordViewBehavior(),this._setAutocompleteBehavior()}_setPasswordViewBehavior(){for(let p of this.component.querySelectorAll('input[type="password"]'))if(!p.disabled)for(let t of p.parentNode.querySelectorAll(".br-button"))t.addEventListener("click",e=>{this._toggleShowPassword(e)},!1)}_toggleShowPassword(p){for(let t of p.currentTarget.querySelectorAll(".fas"))if(t.classList.contains("fa-eye")){t.classList.remove("fa-eye"),t.classList.add("fa-eye-slash");for(let e of this.component.querySelectorAll('input[type="password"]'))e.setAttribute("type","text");for(let e of this.component.querySelectorAll('button[aria-label="Exibir senha"]'))e.setAttribute("aria-checked","true")}else if(t.classList.contains("fa-eye-slash")){t.classList.remove("fa-eye-slash"),t.classList.add("fa-eye");for(let e of this.component.querySelectorAll('input[type="text"]'))e.setAttribute("type","password");for(let e of this.component.querySelectorAll('button[aria-label="Exibir senha"]'))e.setAttribute("aria-checked","false")}}_setAutocompleteBehavior(){for(let p of this.component.querySelectorAll("input.search-autocomplete"))p.addEventListener("input",t=>{this._clearSearchItems(),this._buildSearchItems(t.currentTarget)},!1),p.addEventListener("keydown",t=>{this._handleArrowKeys(t)},!1)}_buildSearchItems(p){let t=window.document.createElement("div");if(t.setAttribute("class","search-items"),this.component.appendChild(t),p.value!==""){for(let e of this.dataList)if(e.substr(0,p.value.length).toUpperCase()===p.value.toUpperCase()){let a=window.document.createElement("div");a.innerHTML=`<strong>${e.substr(0,p.value.length)}</strong>`,a.innerHTML+=e.substr(p.value.length),a.innerHTML+=`<input type="hidden" value="${e}">`,a.addEventListener("click",s=>{for(let l of s.currentTarget.querySelectorAll('input[type="hidden"]'))p.value=l.value;this._clearSearchItems()},!1),t.appendChild(a)}}else this._clearSearchItems()}_clearSearchItems(){for(let p of this.component.querySelectorAll(".search-items")){for(let t of p.querySelectorAll("div"))p.removeChild(t);this.component.removeChild(p)}}_handleArrowKeys(p){switch(p.keyCode){case 13:if(this._currentFocus>-1){p.preventDefault();for(let t of this.component.querySelectorAll(".search-items"))for(let e of t.querySelectorAll("div.is-active"))e.click();this._currentFocus=-1}break;case 38:this._currentFocus>0&&(this._currentFocus-=1),this._switchFocus();break;case 40:for(let t of this.component.querySelectorAll(".search-items"))this._currentFocus<t.querySelectorAll("div").length-1&&(this._currentFocus+=1);this._switchFocus();break;default:break}}_switchFocus(){for(let p of this.component.querySelectorAll(".search-items"))for(let[t,e]of p.querySelectorAll("div").entries())t===this._currentFocus&&e.classList.add("is-active"),t!==this._currentFocus&&e.classList.remove("is-active")}setAutocompleteData(p){this.dataList=p}},Je=ee;var i=function(h){return h.SEPARATOR="separator",h.PERCENT="percent",h.IP="IP",h.CPF_CNPJ="CPF_CNPJ",h.MONTH="M",h.MONTHS="M0",h.MINUTE="m",h.HOUR="h",h.HOURS="H",h.MINUTES="m0",h.HOURS_HOUR="Hh",h.SECONDS="s0",h.HOURS_MINUTES_SECONDS="Hh:m0:s0",h.EMAIL_MASK="A*@A*.A*",h.HOURS_MINUTES="Hh:m0",h.MINUTES_SECONDS="m0:s0",h.DAYS_MONTHS_YEARS="d0/M0/0000",h.DAYS_MONTHS="d0/M0",h.DAYS="d0",h.DAY="d",h.SECOND="s",h.LETTER_S="S",h.DOT=".",h.COMMA=",",h.CURLY_BRACKETS_LEFT="{",h.CURLY_BRACKETS_RIGHT="}",h.MINUS="-",h.OR="||",h.HASH="#",h.EMPTY_STRING="",h.SYMBOL_STAR="*",h.SYMBOL_QUESTION="?",h.SLASH="/",h.WHITE_SPACE=" ",h.NUMBER_ZERO="0",h.NUMBER_NINE="9",h.BACKSPACE="Backspace",h.DELETE="Delete",h.ARROW_LEFT="ArrowLeft",h.ARROW_UP="ArrowUp",h.DOUBLE_ZERO="00",h}(i||{}),K=new G("ngx-mask config"),_e=new G("new ngx-mask config"),ge=new G("initial ngx-mask config"),Ne={suffix:"",prefix:"",thousandSeparator:" ",decimalMarker:[".",","],clearIfNotMatch:!1,showMaskTyped:!1,instantPrefix:!1,placeHolderCharacter:"_",dropSpecialCharacters:!0,hiddenInput:!1,shownMaskExpression:"",separatorLimit:"",allowNegativeNumbers:!1,validation:!0,specialCharacters:["-","/","(",")",".",":"," ","+",",","@","[","]",'"',"'"],leadZeroDateTime:!1,apm:!1,leadZero:!1,keepCharacterPositions:!1,triggerOnMaskChange:!1,inputTransformFn:h=>h,outputTransformFn:h=>h,maskFilled:new ae,patterns:{0:{pattern:new RegExp("\\d")},9:{pattern:new RegExp("\\d"),optional:!0},X:{pattern:new RegExp("\\d"),symbol:"*"},A:{pattern:new RegExp("[a-zA-Z0-9]")},S:{pattern:new RegExp("[a-zA-Z]")},U:{pattern:new RegExp("[A-Z]")},L:{pattern:new RegExp("[a-z]")},d:{pattern:new RegExp("\\d")},m:{pattern:new RegExp("\\d")},M:{pattern:new RegExp("\\d")},H:{pattern:new RegExp("\\d")},h:{pattern:new RegExp("\\d")},s:{pattern:new RegExp("\\d")}}},Ie=[i.HOURS_MINUTES_SECONDS,i.HOURS_MINUTES,i.MINUTES_SECONDS],Re=[i.PERCENT,i.HOURS_HOUR,i.SECONDS,i.MINUTES,i.SEPARATOR,i.DAYS_MONTHS_YEARS,i.DAYS_MONTHS,i.DAYS,i.MONTHS],ye=(()=>{class h{_config=E(K);dropSpecialCharacters=this._config.dropSpecialCharacters;hiddenInput=this._config.hiddenInput;clearIfNotMatch=this._config.clearIfNotMatch;specialCharacters=this._config.specialCharacters;patterns=this._config.patterns;prefix=this._config.prefix;suffix=this._config.suffix;thousandSeparator=this._config.thousandSeparator;decimalMarker=this._config.decimalMarker;customPattern;showMaskTyped=this._config.showMaskTyped;placeHolderCharacter=this._config.placeHolderCharacter;validation=this._config.validation;separatorLimit=this._config.separatorLimit;allowNegativeNumbers=this._config.allowNegativeNumbers;leadZeroDateTime=this._config.leadZeroDateTime;leadZero=this._config.leadZero;apm=this._config.apm;inputTransformFn=this._config.inputTransformFn;outputTransformFn=this._config.outputTransformFn;keepCharacterPositions=this._config.keepCharacterPositions;instantPrefix=this._config.instantPrefix;_shift=new Set;plusOnePosition=!1;maskExpression="";actualValue="";showKeepCharacterExp="";shownMaskExpression="";deletedSpecialCharacter=!1;ipError;cpfCnpjError;applyMask(t,e,a=0,s=!1,l=!1,o=()=>{}){if(!e||typeof t!="string")return i.EMPTY_STRING;let n=0,c="",f=!1,S=!1,_=1,M=!1,r=t,m=a;r.slice(0,this.prefix.length)===this.prefix&&(r=r.slice(this.prefix.length,r.length)),this.suffix&&r.length>0&&(r=this.checkAndRemoveSuffix(r)),r==="("&&this.prefix&&(r="");let C=r.toString().split(i.EMPTY_STRING);if(this.allowNegativeNumbers&&r.slice(n,n+1)===i.MINUS&&(c+=r.slice(n,n+1)),e===i.IP){let d=r.split(i.DOT);this.ipError=this._validIP(d),e="099.099.099.099"}let I=[];for(let d=0;d<r.length;d++)r[d]?.match("\\d")&&I.push(r[d]??i.EMPTY_STRING);if(e===i.CPF_CNPJ&&(this.cpfCnpjError=I.length!==11&&I.length!==14,I.length>11?e="00.000.000/0000-00":e="000.000.000-00"),e.startsWith(i.PERCENT)){if(r.match("[a-z]|[A-Z]")||r.match(/[-!$%^&*()_+|~=`{}\[\]:";'<>?,\/.]/)&&!l){r=this._stripToDecimal(r);let R=this.getPrecision(e);r=this.checkInputPrecision(r,R,this.decimalMarker)}let d=typeof this.decimalMarker=="string"?this.decimalMarker:i.DOT;if(r.indexOf(d)>0&&!this.percentage(r.substring(0,r.indexOf(d)))){let R=r.substring(0,r.indexOf(d)-1);this.allowNegativeNumbers&&r.slice(n,n+1)===i.MINUS&&!l&&(R=r.substring(0,r.indexOf(d))),r=`${R}${r.substring(r.indexOf(d),r.length)}`}let u="";this.allowNegativeNumbers&&r.slice(n,n+1)===i.MINUS?u=`${i.MINUS}${r.slice(n+1,n+r.length)}`:u=r,this.percentage(u)?c=this._splitPercentZero(r):c=this._splitPercentZero(r.substring(0,r.length-1))}else if(e.startsWith(i.SEPARATOR)){(r.match("[w\u0430-\u044F\u0410-\u042F]")||r.match("[\u0401\u0451\u0410-\u044F]")||r.match("[a-z]|[A-Z]")||r.match(/[-@#!$%\\^&*()_£¬'+|~=`{}\]:";<>.?/]/)||r.match("[^A-Za-z0-9,]"))&&(r=this._stripToDecimal(r));let d=this.getPrecision(e),u=this.decimalMarker;if(Array.isArray(this.decimalMarker)&&(this.actualValue.includes(this.decimalMarker[0])||this.actualValue.includes(this.decimalMarker[1])?u=this.actualValue.includes(this.decimalMarker[0])?this.decimalMarker[0]:this.decimalMarker[1]:u=this.decimalMarker.find(g=>g!==this.thousandSeparator)),l){let{decimalMarkerIndex:g,nonZeroIndex:v}=this._findFirstNonZeroAndDecimalIndex(r,u),O=r[0]===i.MINUS,U=r[0]===i.NUMBER_ZERO,B=r[0]===u,Y=r[1]===u;(B&&!v||O&&Y&&!v||U&&!g&&!v)&&(r=i.NUMBER_ZERO),g&&v&&O&&m===1&&(g<v||g>v)&&(r=i.MINUS+r.slice(v)),!g&&v&&r.length>v&&(r=O?i.MINUS+r.slice(v):r.slice(v)),g&&v&&m===0&&(g<v&&(r=r.slice(g-1)),g>v&&(r=r.slice(v)))}d===0?r=this.allowNegativeNumbers?r.length>2&&r[0]===i.MINUS&&r[1]===i.NUMBER_ZERO&&r[2]!==this.thousandSeparator&&r[2]!==i.COMMA&&r[2]!==i.DOT?"-"+r.slice(2,r.length):r[0]===i.NUMBER_ZERO&&r.length>1&&r[1]!==this.thousandSeparator&&r[1]!==i.COMMA&&r[1]!==i.DOT?r.slice(1,r.length):r:r.length>1&&r[0]===i.NUMBER_ZERO&&r[1]!==this.thousandSeparator&&r[1]!==i.COMMA&&r[1]!==i.DOT?r.slice(1,r.length):r:(r[0]===u&&r.length>1&&!l&&(r=i.NUMBER_ZERO+r.slice(0,r.length+1),this.plusOnePosition=!0),r[0]===i.NUMBER_ZERO&&r[1]!==u&&r[1]!==this.thousandSeparator&&!l&&(r=r.length>1?r.slice(0,1)+u+r.slice(1,r.length+1):r,this.plusOnePosition=!0),this.allowNegativeNumbers&&!l&&r[0]===i.MINUS&&(r[1]===u||r[1]===i.NUMBER_ZERO)&&(r=r[1]===u&&r.length>2?r.slice(0,1)+i.NUMBER_ZERO+r.slice(1,r.length):r[1]===i.NUMBER_ZERO&&r.length>2&&r[2]!==u?r.slice(0,2)+u+r.slice(2,r.length):r,this.plusOnePosition=!0));let R=this._charToRegExpExpression(this.thousandSeparator),T='@#!$%^&*()_+|~=`{}\\[\\]:\\s,\\.";<>?\\/'.replace(R,"");if(Array.isArray(this.decimalMarker))for(let g of this.decimalMarker)T=T.replace(this._charToRegExpExpression(g),i.EMPTY_STRING);else T=T.replace(this._charToRegExpExpression(this.decimalMarker),"");let N=new RegExp("["+T+"]");r.match(N)&&(r=r.substring(0,r.length-1)),r=this.checkInputPrecision(r,d,this.decimalMarker);let P=r.replace(new RegExp(R,"g"),"");c=this._formatWithSeparators(P,this.thousandSeparator,this.decimalMarker,d);let W=c.indexOf(i.COMMA)-r.indexOf(i.COMMA),A=c.length-r.length,F=l&&c.length<t.length&&this.separatorLimit;if((c[m-1]===this.thousandSeparator||c[m-this.prefix.length])&&this.prefix&&l)m=m-1;else if(A>0&&c[m]!==this.thousandSeparator||F){S=!0;let g=0;do this._shift.add(m+g),g++;while(g<A)}else c[m-1]===this.thousandSeparator||A===-4||A===-3||c[m]===this.thousandSeparator?(this._shift.clear(),this._shift.add(m-1)):W!==0&&m>0&&!(c.indexOf(i.COMMA)>=m&&m>3)||!(c.indexOf(i.DOT)>=m&&m>3)&&A<=0?(this._shift.clear(),S=!0,_=A,m+=A,this._shift.add(m)):this._shift.clear()}else for(let d=0,u=C[0];d<C.length&&n!==e.length;d++,u=C[d]??i.EMPTY_STRING){let R=i.SYMBOL_STAR in this.patterns;if(this._checkSymbolMask(u,e[n]??i.EMPTY_STRING)&&e[n+1]===i.SYMBOL_QUESTION)c+=u,n+=2;else if(e[n+1]===i.SYMBOL_STAR&&f&&this._checkSymbolMask(u,e[n+2]??i.EMPTY_STRING))c+=u,n+=3,f=!1;else if(this._checkSymbolMask(u,e[n]??i.EMPTY_STRING)&&e[n+1]===i.SYMBOL_STAR&&!R)c+=u,f=!0;else if(e[n+1]===i.SYMBOL_QUESTION&&this._checkSymbolMask(u,e[n+2]??i.EMPTY_STRING))c+=u,n+=3;else if(this._checkSymbolMask(u,e[n]??i.EMPTY_STRING)){if(e[n]===i.HOURS&&(this.apm?Number(u)>9:Number(u)>2)){m=this.leadZeroDateTime?m:m+1,n+=1,this._shiftStep(n),d--,this.leadZeroDateTime&&(c+="0");continue}if(e[n]===i.HOUR&&(this.apm?c.length===1&&Number(c)>1||c==="1"&&Number(u)>2||r.slice(n-1,n).length===1&&Number(r.slice(n-1,n))>2||r.slice(n-1,n)==="1"&&Number(u)>2:c==="2"&&Number(u)>3||(c.slice(n-2,n)==="2"||c.slice(n-3,n)==="2"||c.slice(n-4,n)==="2"||c.slice(n-1,n)==="2")&&Number(u)>3&&n>10)){m=m+1,n+=1,d--;continue}if((e[n]===i.MINUTE||e[n]===i.SECOND)&&Number(u)>5){m=this.leadZeroDateTime?m:m+1,n+=1,this._shiftStep(n),d--,this.leadZeroDateTime&&(c+="0");continue}let T=31,N=r[n],P=r[n+1],W=r[n+2],A=r[n-1],F=r[n-2],g=r.slice(n-3,n-1),v=r.slice(n-1,n+1),O=r.slice(n,n+2),U=r.slice(n-2,n);if(e[n]===i.DAY){let B=e.slice(0,2)===i.MONTHS,Y=e.slice(0,2)===i.MONTHS&&this.specialCharacters.includes(F);if(Number(u)>3&&this.leadZeroDateTime||!B&&(Number(O)>T||Number(v)>T||this.specialCharacters.includes(P))||(Y?Number(v)>T||!this.specialCharacters.includes(N)&&this.specialCharacters.includes(W)||this.specialCharacters.includes(N):Number(O)>T||this.specialCharacters.includes(P)&&!l)){m=this.leadZeroDateTime?m:m+1,n+=1,this._shiftStep(n),d--,this.leadZeroDateTime&&(c+="0");continue}}if(e[n]===i.MONTH){let Y=n===0&&(Number(u)>2||Number(O)>12||this.specialCharacters.includes(P)&&!l),ke=e.slice(n+2,n+3),ve=g.includes(ke)&&e.includes("d0")&&(this.specialCharacters.includes(F)&&Number(v)>12&&!this.specialCharacters.includes(N)||this.specialCharacters.includes(N)),Me=Number(g)<=T&&!this.specialCharacters.includes(g)&&this.specialCharacters.includes(A)&&(Number(O)>12||this.specialCharacters.includes(P)),Te=Number(O)>12&&n===5||this.specialCharacters.includes(P)&&n===5,Ce=Number(g)>T&&!this.specialCharacters.includes(g)&&!this.specialCharacters.includes(U)&&Number(U)>12&&e.includes("d0"),Ee=Number(g)<=T&&!this.specialCharacters.includes(g)&&!this.specialCharacters.includes(A)&&Number(v)>12;if(Number(u)>1&&this.leadZeroDateTime||Y||ve||Ee||Ce||Me||Te&&!this.leadZeroDateTime){m=this.leadZeroDateTime?m:m+1,n+=1,this._shiftStep(n),d--,this.leadZeroDateTime&&(c+="0");continue}}c+=u,n++}else this.specialCharacters.includes(u)&&e[n]===u?(c+=u,n++):this.specialCharacters.indexOf(e[n]??i.EMPTY_STRING)!==-1?(c+=e[n],n++,this._shiftStep(n),d--):e[n]===i.NUMBER_NINE&&this.showMaskTyped?this._shiftStep(n):this.patterns[e[n]??i.EMPTY_STRING]&&this.patterns[e[n]??i.EMPTY_STRING]?.optional?(C[n]&&e!=="099.099.099.099"&&e!=="000.000.000-00"&&e!=="00.000.000/0000-00"&&!e.match(/^9+\.0+$/)&&!this.patterns[e[n]??i.EMPTY_STRING]?.optional&&(c+=C[n]),e.includes(i.NUMBER_NINE+i.SYMBOL_STAR)&&e.includes(i.NUMBER_ZERO+i.SYMBOL_STAR)&&n++,n++,d--):this.maskExpression[n+1]===i.SYMBOL_STAR&&this._findSpecialChar(this.maskExpression[n+2]??i.EMPTY_STRING)&&this._findSpecialChar(u)===this.maskExpression[n+2]&&f||this.maskExpression[n+1]===i.SYMBOL_QUESTION&&this._findSpecialChar(this.maskExpression[n+2]??i.EMPTY_STRING)&&this._findSpecialChar(u)===this.maskExpression[n+2]&&f?(n+=3,c+=u):this.showMaskTyped&&this.specialCharacters.indexOf(u)<0&&u!==this.placeHolderCharacter&&this.placeHolderCharacter.length===1&&(M=!0)}c[m-1]&&c.length+1===e.length&&this.specialCharacters.indexOf(e[e.length-1]??i.EMPTY_STRING)!==-1&&(c+=e[e.length-1]);let b=m+1;for(;this._shift.has(b);)_++,b++;let w=s&&!e.startsWith(i.SEPARATOR)?n:this._shift.has(m)?_:0;M&&w--,o(w,S),_<0&&this._shift.clear();let V=!1;l&&(V=C.every(d=>this.specialCharacters.includes(d)));let D=`${this.prefix}${V?i.EMPTY_STRING:c}${this.showMaskTyped?"":this.suffix}`;c.length===0&&(D=this.instantPrefix?`${this.prefix}${c}`:`${c}`);let $=r.length===1&&this.specialCharacters.includes(e[0])&&r!==e[0];if(!this._checkSymbolMask(r,e[1])&&$)return"";if(c.includes(i.MINUS)&&this.prefix&&this.allowNegativeNumbers){if(l&&c===i.MINUS)return"";D=`${i.MINUS}${this.prefix}${c.split(i.MINUS).join(i.EMPTY_STRING)}${this.suffix}`}return D}_findDropSpecialChar(t){return Array.isArray(this.dropSpecialCharacters)?this.dropSpecialCharacters.find(e=>e===t):this._findSpecialChar(t)}_findSpecialChar(t){return this.specialCharacters.find(e=>e===t)}_checkSymbolMask(t,e){return this.patterns=this.customPattern?this.customPattern:this.patterns,(this.patterns[e]?.pattern&&this.patterns[e]?.pattern.test(t))??!1}_formatWithSeparators=(t,e,a,s)=>{let l=[],o="";if(Array.isArray(a)){let _=new RegExp(a.map(M=>"[\\^$.|?*+()".indexOf(M)>=0?`\\${M}`:M).join("|"));l=t.split(_),o=t.match(_)?.[0]??i.EMPTY_STRING}else l=t.split(a),o=a;let n=l.length>1?`${o}${l[1]}`:i.EMPTY_STRING,c=l[0]??i.EMPTY_STRING,f=this.separatorLimit.replace(/\s/g,i.EMPTY_STRING);f&&+f&&(c[0]===i.MINUS?c=`-${c.slice(1,c.length).slice(0,f.length)}`:c=c.slice(0,f.length));let S=/(\d+)(\d{3})/;for(;e&&S.test(c);)c=c.replace(S,"$1"+e+"$2");return typeof s>"u"?c+n:s===0?c:c+n.substring(0,s+1)};percentage=t=>{let e=t.replace(",","."),a=Number(this.allowNegativeNumbers&&t.includes(i.MINUS)?e.slice(1,t.length):e);return!isNaN(a)&&a>=0&&a<=100};getPrecision=t=>{let e=t.split(i.DOT);return e.length>1?Number(e[e.length-1]):1/0};checkAndRemoveSuffix=t=>{for(let e=this.suffix?.length-1;e>=0;e--){let a=this.suffix.substring(e,this.suffix?.length);if(t.includes(a)&&e!==this.suffix?.length-1&&(e-1<0||!t.includes(this.suffix.substring(e-1,this.suffix?.length))))return t.replace(a,i.EMPTY_STRING)}return t};checkInputPrecision=(t,e,a)=>{let s=t,l=a;if(e<1/0){if(Array.isArray(l)){let f=l.find(S=>S!==this.thousandSeparator);l=f||l[0]}let o=new RegExp(this._charToRegExpExpression(l)+`\\d{${e}}.*$`),n=s.match(o),c=(n&&n[0]?.length)??0;if(c-1>e){let f=c-1-e;s=s.substring(0,s.length-f)}e===0&&this._compareOrIncludes(s[s.length-1],l,this.thousandSeparator)&&(s=s.substring(0,s.length-1))}return s};_stripToDecimal(t){return t.split(i.EMPTY_STRING).filter((e,a)=>{let s=typeof this.decimalMarker=="string"?e===this.decimalMarker:this.decimalMarker.includes(e);return e.match("^-?\\d")||e===this.thousandSeparator||s||e===i.MINUS&&a===0&&this.allowNegativeNumbers}).join(i.EMPTY_STRING)}_charToRegExpExpression(t){return t&&(t===" "?"\\s":"[\\^$.|?*+()".indexOf(t)>=0?`\\${t}`:t)}_shiftStep(t){this._shift.add(t+this.prefix.length||0)}_compareOrIncludes(t,e,a){return Array.isArray(e)?e.filter(s=>s!==a).includes(t):t===e}_validIP(t){return!(t.length===4&&!t.some((e,a)=>t.length!==a+1?e===i.EMPTY_STRING||Number(e)>255:e===i.EMPTY_STRING||Number(e.substring(0,3))>255))}_splitPercentZero(t){if(t===i.MINUS&&this.allowNegativeNumbers)return t;let e=typeof this.decimalMarker=="string"?t.indexOf(this.decimalMarker):t.indexOf(i.DOT),a=this.allowNegativeNumbers&&t.includes(i.MINUS)?"-":"";if(e===-1){let s=parseInt(a?t.slice(1,t.length):t,10);return isNaN(s)?i.EMPTY_STRING:`${a}${s}`}else{let s=parseInt(t.replace("-","").substring(0,e),10),l=t.substring(e+1),o=isNaN(s)?"":s.toString(),n=typeof this.decimalMarker=="string"?this.decimalMarker:i.DOT;return o===i.EMPTY_STRING?i.EMPTY_STRING:`${a}${o}${n}${l}`}}_findFirstNonZeroAndDecimalIndex(t,e){let a=null,s=null;for(let l=0;l<t.length;l++){let o=t[l];if(o===e&&a===null&&(a=l),o&&o>="1"&&o<="9"&&s===null&&(s=l),a!==null&&s!==null)break}return{decimalMarkerIndex:a,nonZeroIndex:s}}static \u0275fac=function(e){return new(e||h)};static \u0275prov=x({token:h,factory:h.\u0275fac})}return h})(),te=(()=>{class h extends ye{isNumberValue=!1;maskIsShown="";selStart=null;selEnd=null;maskChanged=!1;maskExpressionArray=[];triggerOnMaskChange=!1;previousValue="";currentValue="";writingValue=!1;_emitValue=!1;_start;_end;onChange=t=>{};_elementRef=E(le,{optional:!0});document=E(J);_config=E(K);_renderer=E(he,{optional:!0});applyMask(t,e,a=0,s=!1,l=!1,o=()=>{}){if(!e)return t!==this.actualValue?this.actualValue:t;if(this.maskIsShown=this.showMaskTyped?this.showMaskInInput():i.EMPTY_STRING,this.maskExpression===i.IP&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(t||i.HASH)),this.maskExpression===i.CPF_CNPJ&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(t||i.HASH)),!t&&this.showMaskTyped)return this.formControlResult(this.prefix),`${this.prefix}${this.maskIsShown}${this.suffix}`;let n=t&&typeof this.selStart=="number"?t[this.selStart]??i.EMPTY_STRING:i.EMPTY_STRING,c="",f=a;if((this.hiddenInput||t&&t.indexOf(i.SYMBOL_STAR)>=0)&&!this.writingValue){let r=t&&t.length===1?t.split(i.EMPTY_STRING):this.actualValue.split(i.EMPTY_STRING);l&&(r=r.slice(0,a).concat(r.slice(a+1))),this.showMaskTyped&&(t=this.removeMask(t),r=this.removeMask(r.join("")).split(i.EMPTY_STRING)),typeof this.selStart=="object"&&typeof this.selEnd=="object"?(this.selStart=Number(this.selStart),this.selEnd=Number(this.selEnd)):t!==i.EMPTY_STRING&&r.length?typeof this.selStart=="number"&&typeof this.selEnd=="number"&&(t.length>r.length?r.splice(this.selStart,0,n):t.length<r.length&&(r.length-t.length===1?l?r.splice(this.selStart-1,1):r.splice(t.length-1,1):r.splice(this.selStart,this.selEnd-this.selStart))):r=[],this.showMaskTyped&&!this.hiddenInput&&(c=this.removeMask(t)),this.actualValue.length?r.length<t.length?c=this.shiftTypedSymbols(r.join(i.EMPTY_STRING)):r.length===t.length?c=r.join(i.EMPTY_STRING):c=t:c=t}if(s&&(this.hiddenInput||!this.hiddenInput)&&(c=t),l&&this.specialCharacters.indexOf(this.maskExpression[f]??i.EMPTY_STRING)!==-1&&this.showMaskTyped&&!this.prefix&&(c=this.currentValue),this.deletedSpecialCharacter&&f&&(this.specialCharacters.includes(this.actualValue.slice(f,f+1))?f=f+1:e.slice(f-1,f+1)!==i.MONTHS&&(f=f-2),this.deletedSpecialCharacter=!1),this.showMaskTyped&&this.placeHolderCharacter.length===1&&!this.leadZeroDateTime&&(c=this.removeMask(c)),this.maskChanged?c=t:c=c&&c.length?c:t,this.showMaskTyped&&this.keepCharacterPositions&&this.actualValue&&!s&&!this.writingValue){let r=this.dropSpecialCharacters?this.removeMask(this.actualValue):this.actualValue;return this.formControlResult(r),this.actualValue?this.actualValue:`${this.prefix}${this.maskIsShown}${this.suffix}`}let S=super.applyMask(c,e,f,s,l,o);if(this.actualValue=this.getActualValue(S),this.thousandSeparator===i.DOT&&this.decimalMarker===i.DOT&&(this.decimalMarker=i.COMMA),this.maskExpression.startsWith(i.SEPARATOR)&&this.dropSpecialCharacters===!0&&(this.specialCharacters=this.specialCharacters.filter(r=>!this._compareOrIncludes(r,this.decimalMarker,this.thousandSeparator))),(S||S==="")&&(this.previousValue=this.currentValue,this.currentValue=S,this._emitValue=this.previousValue!==this.currentValue||this.maskChanged||this.writingValue||this.previousValue===this.currentValue&&s),this._emitValue&&(this.writingValue&&this.triggerOnMaskChange?requestAnimationFrame(()=>this.formControlResult(S)):this.formControlResult(S)),!this.showMaskTyped||this.showMaskTyped&&this.hiddenInput)return this.hiddenInput?`${this.hideInput(S,this.maskExpression)}${this.maskIsShown.slice(S.length)}`:S;let _=S.length,M=`${this.prefix}${this.maskIsShown}${this.suffix}`;if(this.maskExpression.includes(i.HOURS)){let r=this._numberSkipedSymbols(S);return`${S}${M.slice(_+r)}`}else if(this.maskExpression===i.IP||this.maskExpression===i.CPF_CNPJ)return`${S}${M}`;return`${S}${M.slice(_)}`}_numberSkipedSymbols(t){let e=/(^|\D)(\d\D)/g,a=e.exec(t),s=0;for(;a!=null;)s+=1,a=e.exec(t);return s}applyValueChanges(t,e,a,s=()=>{}){let l=this._elementRef?.nativeElement;l&&(l.value=this.applyMask(l.value,this.maskExpression,t,e,a,s),l!==this._getActiveElement()&&this.clearIfNotMatchFn())}hideInput(t,e){return t.split(i.EMPTY_STRING).map((a,s)=>this.patterns&&this.patterns[e[s]??i.EMPTY_STRING]&&this.patterns[e[s]??i.EMPTY_STRING]?.symbol?this.patterns[e[s]??i.EMPTY_STRING]?.symbol:a).join(i.EMPTY_STRING)}getActualValue(t){let e=t.split(i.EMPTY_STRING).filter((a,s)=>{let l=this.maskExpression[s]??i.EMPTY_STRING;return this._checkSymbolMask(a,l)||this.specialCharacters.includes(l)&&a===l});return e.join(i.EMPTY_STRING)===t?e.join(i.EMPTY_STRING):t}shiftTypedSymbols(t){let e="";return(t&&t.split(i.EMPTY_STRING).map((s,l)=>{if(this.specialCharacters.includes(t[l+1]??i.EMPTY_STRING)&&t[l+1]!==this.maskExpression[l+1])return e=s,t[l+1];if(e.length){let o=e;return e=i.EMPTY_STRING,o}return s})||[]).join(i.EMPTY_STRING)}numberToString(t){return!t&&t!==0||this.maskExpression.startsWith(i.SEPARATOR)&&(this.leadZero||!this.dropSpecialCharacters)||this.maskExpression.startsWith(i.SEPARATOR)&&this.separatorLimit.length>14&&String(t).length>14?String(t):Number(t).toLocaleString("fullwide",{useGrouping:!1,maximumFractionDigits:20}).replace(`/${i.MINUS}/`,i.MINUS)}showMaskInInput(t){if(this.showMaskTyped&&this.shownMaskExpression){if(this.maskExpression.length!==this.shownMaskExpression.length)throw new Error("Mask expression must match mask placeholder length");return this.shownMaskExpression}else if(this.showMaskTyped){if(t){if(this.maskExpression===i.IP)return this._checkForIp(t);if(this.maskExpression===i.CPF_CNPJ)return this._checkForCpfCnpj(t)}return this.placeHolderCharacter.length===this.maskExpression.length?this.placeHolderCharacter:this.maskExpression.replace(/\w/g,this.placeHolderCharacter)}return""}clearIfNotMatchFn(){let t=this._elementRef?.nativeElement;t&&this.clearIfNotMatch&&this.prefix.length+this.maskExpression.length+this.suffix.length!==t.value.replace(this.placeHolderCharacter,i.EMPTY_STRING).length&&(this.formElementProperty=["value",i.EMPTY_STRING],this.applyMask("",this.maskExpression))}set formElementProperty([t,e]){!this._renderer||!this._elementRef||Promise.resolve().then(()=>this._renderer?.setProperty(this._elementRef?.nativeElement,t,e))}checkDropSpecialCharAmount(t){return t.split(i.EMPTY_STRING).filter(a=>this._findDropSpecialChar(a)).length}removeMask(t){return this._removeMask(this._removeSuffix(this._removePrefix(t)),this.specialCharacters.concat("_").concat(this.placeHolderCharacter))}_checkForIp(t){if(t===i.HASH)return`${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`;let e=[];for(let a=0;a<t.length;a++){let s=t[a]??i.EMPTY_STRING;s&&s.match("\\d")&&e.push(s)}return e.length<=3?`${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`:e.length>3&&e.length<=6?`${this.placeHolderCharacter}.${this.placeHolderCharacter}`:e.length>6&&e.length<=9?this.placeHolderCharacter:(e.length>9&&e.length<=12,"")}_checkForCpfCnpj(t){let e=`${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}-${this.placeHolderCharacter}${this.placeHolderCharacter}`,a=`${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}/${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}-${this.placeHolderCharacter}${this.placeHolderCharacter}`;if(t===i.HASH)return e;let s=[];for(let l=0;l<t.length;l++){let o=t[l]??i.EMPTY_STRING;o&&o.match("\\d")&&s.push(o)}return s.length<=3?e.slice(s.length,e.length):s.length>3&&s.length<=6?e.slice(s.length+1,e.length):s.length>6&&s.length<=9?e.slice(s.length+2,e.length):s.length>9&&s.length<11?e.slice(s.length+3,e.length):s.length===11?"":s.length===12?t.length===17?a.slice(16,a.length):a.slice(15,a.length):s.length>12&&s.length<=14?a.slice(s.length+4,a.length):""}_getActiveElement(t=this.document){let e=t?.activeElement?.shadowRoot;return e?.activeElement?this._getActiveElement(e):t.activeElement}formControlResult(t){if(this.writingValue&&!t){this.onChange(this.outputTransformFn(null));return}if(this.writingValue||!this.triggerOnMaskChange&&this.maskChanged){this.triggerOnMaskChange&&this.maskChanged&&this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeSuffix(this._removePrefix(t)))))),this.writingValue=!1,this.maskChanged=!1;return}Array.isArray(this.dropSpecialCharacters)?this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeMask(this._removeSuffix(this._removePrefix(t)),this.dropSpecialCharacters))))):this.dropSpecialCharacters||!this.dropSpecialCharacters&&this.prefix===t?this.onChange(this.outputTransformFn(this._toNumber(this._checkSymbols(this._removeSuffix(this._removePrefix(t)))))):this.onChange(this.outputTransformFn(this._toNumber(t)))}_toNumber(t){if(!this.isNumberValue||t===i.EMPTY_STRING||this.maskExpression.startsWith(i.SEPARATOR)&&(this.leadZero||!this.dropSpecialCharacters))return t;if(String(t).length>14&&this.maskExpression.startsWith(i.SEPARATOR))return String(t);let e=Number(t);if(this.maskExpression.startsWith(i.SEPARATOR)&&Number.isNaN(e)){let a=String(t).replace(",",".");return Number(a)}return Number.isNaN(e)?t:e}_removeMask(t,e){return this.maskExpression.startsWith(i.PERCENT)&&t.includes(i.DOT)?t:t&&t.replace(this._regExpForRemove(e),i.EMPTY_STRING)}_removePrefix(t){return this.prefix?t&&t.replace(this.prefix,i.EMPTY_STRING):t}_removeSuffix(t){return this.suffix?t&&t.replace(this.suffix,i.EMPTY_STRING):t}_retrieveSeparatorValue(t){let e=Array.isArray(this.dropSpecialCharacters)?this.specialCharacters.filter(a=>this.dropSpecialCharacters.includes(a)):this.specialCharacters;return!this.deletedSpecialCharacter&&this._checkPatternForSpace()&&t.includes(i.WHITE_SPACE)&&this.maskExpression.includes(i.SYMBOL_STAR)&&(e=e.filter(a=>a!==i.WHITE_SPACE)),this._removeMask(t,e)}_regExpForRemove(t){return new RegExp(t.map(e=>`\\${e}`).join("|"),"gi")}_replaceDecimalMarkerToDot(t){let e=Array.isArray(this.decimalMarker)?this.decimalMarker:[this.decimalMarker];return t.replace(this._regExpForRemove(e),i.DOT)}_checkSymbols(t){let e=t;if(e===i.EMPTY_STRING)return e;this.maskExpression.startsWith(i.PERCENT)&&this.decimalMarker===i.COMMA&&(e=e.replace(i.COMMA,i.DOT));let a=this._retrieveSeparatorPrecision(this.maskExpression),s=this.specialCharacters.length===0?this._retrieveSeparatorValue(e):this._replaceDecimalMarkerToDot(this._retrieveSeparatorValue(e));return this.isNumberValue&&a?e===this.decimalMarker?null:s.length>14?String(s):this._checkPrecision(this.maskExpression,s):s}_checkPatternForSpace(){for(let t in this.patterns)if(this.patterns[t]&&this.patterns[t]?.hasOwnProperty("pattern")){let e=this.patterns[t]?.pattern.toString(),a=this.patterns[t]?.pattern;if(e?.includes(i.WHITE_SPACE)&&a?.test(this.maskExpression))return!0}return!1}_retrieveSeparatorPrecision(t){let e=t.match(new RegExp("^separator\\.([^d]*)"));return e?Number(e[1]):null}_checkPrecision(t,e){let a=this.getPrecision(t),s=e;return t.indexOf("2")>0||this.leadZero&&Number(a)>0?(this.decimalMarker===i.COMMA&&this.leadZero&&(s=s.replace(",",".")),this.leadZero?Number(s).toFixed(Number(a)):Number(s).toFixed(2)):this.numberToString(s)}_repeatPatternSymbols(t){return t.match(/{[0-9]+}/)&&t.split(i.EMPTY_STRING).reduce((e,a,s)=>{if(this._start=a===i.CURLY_BRACKETS_LEFT?s:this._start,a!==i.CURLY_BRACKETS_RIGHT)return this._findSpecialChar(a)?e+a:e;this._end=s;let l=Number(t.slice(this._start+1,this._end)),o=new Array(l+1).join(t[this._start-1]);if(t.slice(0,this._start).length>1&&t.includes(i.LETTER_S)){let n=t.slice(0,this._start-1);return n.includes(i.CURLY_BRACKETS_LEFT)?e+o:n+e+o}else return e+o},"")||t}currentLocaleDecimalMarker(){return 1.1.toLocaleString().substring(1,2)}static \u0275fac=(()=>{let t;return function(a){return(t||(t=Z(h)))(a||h)}})();static \u0275prov=x({token:h,factory:h.\u0275fac})}return h})();function Ae(){let h=E(ge),p=E(_e);return p instanceof Function?H(H({},h),p()):H(H({},h),p)}function Pe(h){return[{provide:_e,useValue:h},{provide:ge,useValue:Ne},{provide:K,useFactory:Ae},te]}function ct(h){return se(Pe(h))}var ot=(()=>{class h{mask=k("");specialCharacters=k([]);patterns=k({});prefix=k("");suffix=k("");thousandSeparator=k(" ");decimalMarker=k(".");dropSpecialCharacters=k(null);hiddenInput=k(null);showMaskTyped=k(null);placeHolderCharacter=k(null);shownMaskExpression=k(null);clearIfNotMatch=k(null);validation=k(null);separatorLimit=k("");allowNegativeNumbers=k(null);leadZeroDateTime=k(null);leadZero=k(null);triggerOnMaskChange=k(null);apm=k(null);inputTransformFn=k(null);outputTransformFn=k(null);keepCharacterPositions=k(null);instantPrefix=k(null);maskFilled=ne();_maskValue=y("");_inputValue=y("");_position=y(null);_code=y("");_maskExpressionArray=y([]);_justPasted=y(!1);_isFocused=y(!1);_isComposing=y(!1);_maskService=E(te,{self:!0});document=E(J);_config=E(K);onChange=t=>{};onTouch=()=>{};ngOnChanges(t){let{mask:e,specialCharacters:a,patterns:s,prefix:l,suffix:o,thousandSeparator:n,decimalMarker:c,dropSpecialCharacters:f,hiddenInput:S,showMaskTyped:_,placeHolderCharacter:M,shownMaskExpression:r,clearIfNotMatch:m,validation:C,separatorLimit:I,allowNegativeNumbers:b,leadZeroDateTime:w,leadZero:V,triggerOnMaskChange:D,apm:$,inputTransformFn:d,outputTransformFn:u,keepCharacterPositions:R,instantPrefix:T}=t;if(e&&(e.currentValue!==e.previousValue&&!e.firstChange&&(this._maskService.maskChanged=!0),e.currentValue&&e.currentValue.split(i.OR).length>1?(this._maskExpressionArray.set(e.currentValue.split(i.OR).sort((N,P)=>N.length-P.length)),this._setMask()):(this._maskExpressionArray.set([]),this._maskValue.set(e.currentValue||i.EMPTY_STRING),this._maskService.maskExpression=this._maskValue())),a){if(!a.currentValue||!Array.isArray(a.currentValue))return;this._maskService.specialCharacters=a.currentValue||[]}if(b&&(this._maskService.allowNegativeNumbers=b.currentValue,this._maskService.allowNegativeNumbers&&(this._maskService.specialCharacters=this._maskService.specialCharacters.filter(N=>N!==i.MINUS))),s&&s.currentValue&&(this._maskService.patterns=s.currentValue),$&&$.currentValue&&(this._maskService.apm=$.currentValue),T&&(this._maskService.instantPrefix=T.currentValue),l&&(this._maskService.prefix=l.currentValue),o&&(this._maskService.suffix=o.currentValue),n&&(this._maskService.thousandSeparator=n.currentValue,n.previousValue&&n.currentValue)){let N=this._maskService.decimalMarker;n.currentValue===this._maskService.decimalMarker&&(this._maskService.decimalMarker=n.currentValue===i.COMMA?i.DOT:i.COMMA),this._maskService.dropSpecialCharacters===!0&&(this._maskService.specialCharacters=this._config.specialCharacters),typeof N=="string"&&typeof this._maskService.decimalMarker=="string"&&(this._inputValue.set(this._inputValue().split(n.previousValue).join("").replace(N,this._maskService.decimalMarker)),this._maskService.actualValue=this._inputValue()),this._maskService.writingValue=!0}c&&(this._maskService.decimalMarker=c.currentValue),f&&(this._maskService.dropSpecialCharacters=f.currentValue),S&&(this._maskService.hiddenInput=S.currentValue,S.previousValue===!0&&S.currentValue===!1&&this._inputValue.set(this._maskService.actualValue)),_&&(this._maskService.showMaskTyped=_.currentValue,_.previousValue===!1&&_.currentValue===!0&&this._isFocused()&&requestAnimationFrame(()=>{this._maskService._elementRef?.nativeElement.click()})),M&&(this._maskService.placeHolderCharacter=M.currentValue),r&&(this._maskService.shownMaskExpression=r.currentValue),m&&(this._maskService.clearIfNotMatch=m.currentValue),C&&(this._maskService.validation=C.currentValue),I&&(this._maskService.separatorLimit=I.currentValue),w&&(this._maskService.leadZeroDateTime=w.currentValue),V&&(this._maskService.leadZero=V.currentValue),D&&(this._maskService.triggerOnMaskChange=D.currentValue),d&&(this._maskService.inputTransformFn=d.currentValue),u&&(this._maskService.outputTransformFn=u.currentValue),R&&(this._maskService.keepCharacterPositions=R.currentValue),this._applyMask()}validate({value:t}){let e=typeof t=="number"?String(t):t,a=this._maskValue();if(!this._maskService.validation||!a)return null;if(this._maskService.ipError)return this._createValidationError(e);if(this._maskService.cpfCnpjError)return this._createValidationError(e);if(a.startsWith(i.SEPARATOR)||Re.includes(a)||this._maskService.clearIfNotMatch)return null;if(Ie.includes(a))return this._validateTime(e);if(a===i.EMAIL_MASK)return!/^[^@]+@[^@]+\.[^@]+$/.test(e)&&e?this._createValidationError(e):null;if(e&&e.length>=1){let s=0;if(a.includes(i.CURLY_BRACKETS_LEFT)&&a.includes(i.CURLY_BRACKETS_RIGHT))return a.slice(a.indexOf(i.CURLY_BRACKETS_LEFT)+1,a.indexOf(i.CURLY_BRACKETS_RIGHT))===String(e.length)?null:this._createValidationError(e);if(a.startsWith(i.PERCENT))return null;for(let l in this._maskService.patterns)if(this._maskService.patterns[l]?.optional){if(a.indexOf(l)!==a.lastIndexOf(l)){let o=a.split(i.EMPTY_STRING).filter(n=>n===l).join(i.EMPTY_STRING);s+=o.length}else a.indexOf(l)!==-1&&s++;if(a.indexOf(l)!==-1&&e.length>=a.indexOf(l)||s===a.length)return null}if(a.indexOf(i.SYMBOL_STAR)>1&&e.length<a.indexOf(i.SYMBOL_STAR)||a.indexOf(i.SYMBOL_QUESTION)>1&&e.length<a.indexOf(i.SYMBOL_QUESTION))return this._createValidationError(e);if(a.indexOf(i.SYMBOL_STAR)===-1||a.indexOf(i.SYMBOL_QUESTION)===-1){let l=a.split("*"),o=this._maskService.dropSpecialCharacters?a.length-this._maskService.checkDropSpecialCharAmount(a)-s:this.prefix()?a.length+this.prefix().length-s:a.length-s;if(l.length===1&&e.length<o)return this._createValidationError(e);if(l.length>1){let n=l[l.length-1];if(n&&this._maskService.specialCharacters.includes(n[0])&&String(e).includes(n[0]??"")&&!this.dropSpecialCharacters()){let c=t.split(n[0]);return c[c.length-1].length===n.length-1?null:this._createValidationError(e)}else return(n&&!this._maskService.specialCharacters.includes(n[0])||!n||this._maskService.dropSpecialCharacters)&&e.length>=o-1?null:this._createValidationError(e)}}if(a.indexOf(i.SYMBOL_STAR)===1||a.indexOf(i.SYMBOL_QUESTION)===1)return null}return t&&this.maskFilled.emit(),null}onPaste(){this._justPasted.set(!0)}onFocus(){this._isFocused.set(!0)}onModelChange(t){(t===i.EMPTY_STRING||t===null||typeof t>"u")&&this._maskService.actualValue&&(this._maskService.actualValue=this._maskService.getActualValue(i.EMPTY_STRING))}onInput(t){if(this._isComposing())return;let e=t.target,a=this._maskService.inputTransformFn(e.value);if(e.type!=="number")if(typeof a=="string"||typeof a=="number"){if(e.value=a.toString(),this._inputValue.set(e.value),this._setMask(),!this._maskValue()){this.onChange(e.value);return}let s=e.selectionStart===1?e.selectionStart+this._maskService.prefix.length:e.selectionStart;if(this.showMaskTyped()&&this.keepCharacterPositions()&&this._maskService.placeHolderCharacter.length===1){let c=this.suffix(),f=this.prefix(),S=e.value.slice(s-1,s),_=f.length,M=this._maskService._checkSymbolMask(S,this._maskService.maskExpression[s-1-_]??i.EMPTY_STRING),r=this._maskService._checkSymbolMask(S,this._maskService.maskExpression[s+1-_]??i.EMPTY_STRING),m=this._maskService.selStart===this._maskService.selEnd,C=Number(this._maskService.selStart)-_,I=Number(this._maskService.selEnd)-_,b=this._code()===i.BACKSPACE||this._code()===i.DELETE;if(b){if(!m)this._maskService.selStart===_?this._maskService.actualValue=`${f}${this._maskService.maskIsShown.slice(0,I)}${this._inputValue().split(f).join("")}`:this._maskService.selStart===this._maskService.maskIsShown.length+_?this._maskService.actualValue=`${this._inputValue()}${this._maskService.maskIsShown.slice(C,I)}`:this._maskService.actualValue=`${f}${this._inputValue().split(f).join("").slice(0,C)}${this._maskService.maskIsShown.slice(C,I)}${this._maskService.actualValue.slice(I+_,this._maskService.maskIsShown.length+_)}${c}`;else if(!this._maskService.specialCharacters.includes(this._maskService.maskExpression.slice(s-_,s+1-_))&&m)if(C===1&&f)this._maskService.actualValue=`${f}${this._maskService.placeHolderCharacter}${e.value.split(f).join("").split(c).join("")}${c}`,s=s-1;else{let w=e.value.substring(0,s),V=e.value.substring(s);this._maskService.actualValue=`${w}${this._maskService.placeHolderCharacter}${V}`}s=this._code()===i.DELETE?s+1:s}b||(!M&&!r&&m?s=Number(e.selectionStart)-1:this._maskService.specialCharacters.includes(e.value.slice(s,s+1))&&r&&!this._maskService.specialCharacters.includes(e.value.slice(s+1,s+2))?(this._maskService.actualValue=`${e.value.slice(0,s-1)}${e.value.slice(s,s+1)}${S}${e.value.slice(s+2)}`,s=s+1):M?e.value.length===1&&s===1?this._maskService.actualValue=`${f}${S}${this._maskService.maskIsShown.slice(1,this._maskService.maskIsShown.length)}${c}`:this._maskService.actualValue=`${e.value.slice(0,s-1)}${S}${e.value.slice(s+1).split(c).join("")}${c}`:f&&e.value.length===1&&s-_===1&&this._maskService._checkSymbolMask(e.value,this._maskService.maskExpression[s-1-_]??i.EMPTY_STRING)&&(this._maskService.actualValue=`${f}${e.value}${this._maskService.maskIsShown.slice(1,this._maskService.maskIsShown.length)}${c}`))}let l=0,o=!1;if(this._code()===i.DELETE&&i.SEPARATOR&&(this._maskService.deletedSpecialCharacter=!0),this._inputValue().length>=this._maskService.maskExpression.length-1&&this._code()!==i.BACKSPACE&&this._maskService.maskExpression===i.DAYS_MONTHS_YEARS&&s<10){let c=this._inputValue().slice(s-1,s);e.value=this._inputValue().slice(0,s-1)+c+this._inputValue().slice(s+1)}if(this._maskService.maskExpression===i.DAYS_MONTHS_YEARS&&this.leadZeroDateTime()&&(s<3&&Number(e.value)>31&&Number(e.value)<40||s===5&&Number(e.value.slice(3,5))>12)&&(s=s+2),this._maskService.maskExpression===i.HOURS_MINUTES_SECONDS&&this.apm()&&(this._justPasted()&&e.value.slice(0,2)===i.DOUBLE_ZERO&&(e.value=e.value.slice(1,2)+e.value.slice(2,e.value.length)),e.value=e.value===i.DOUBLE_ZERO?i.NUMBER_ZERO:e.value),this._maskService.applyValueChanges(s,this._justPasted(),this._code()===i.BACKSPACE||this._code()===i.DELETE,(c,f)=>{this._justPasted.set(!1),l=c,o=f}),this._getActiveElement()!==e)return;if(this._maskService.plusOnePosition&&(s=s+1,this._maskService.plusOnePosition=!1),this._maskExpressionArray().length)if(this._code()===i.BACKSPACE){let c=this.specialCharacters().includes(this._maskService.actualValue.slice(s-1,s)),f=this._maskService.removeMask(this._inputValue())?.length===this._maskService.removeMask(this._maskService.maskExpression)?.length,S=this.specialCharacters().includes(this._maskService.actualValue.slice(s,s+1));f&&!S?s=e.selectionStart+1:s=c?s-1:s}else s=e.selectionStart===1?e.selectionStart+this._maskService.prefix.length:e.selectionStart;this._position.set(this._position()===1&&this._inputValue().length===1?null:this._position());let n=this._position()?this._inputValue().length+s+l:s+(this._code()===i.BACKSPACE&&!o?0:l);n>this._getActualInputLength()&&(n=e.value===this._maskService.decimalMarker&&e.value.length===1?this._getActualInputLength()+1:this._getActualInputLength()),n<0&&(n=0),e.setSelectionRange(n,n),this._position.set(null)}else console.warn("Ngx-mask writeValue work with string | number, your current value:",typeof a);else{if(!this._maskValue()){this.onChange(e.value);return}this._maskService.applyValueChanges(e.value.length,this._justPasted(),this._code()===i.BACKSPACE||this._code()===i.DELETE)}}onCompositionStart(){this._isComposing.set(!0)}onCompositionEnd(t){this._isComposing.set(!1),this._justPasted.set(!0),this.onInput(t)}onBlur(t){if(this._maskValue()){let e=t.target;if(this._maskService.leadZero&&e.value.length>0&&typeof this._maskService.decimalMarker=="string"){let a=this._maskService.maskExpression,s=this._maskService.decimalMarker,l=this._maskService.suffix,o=Number(this._maskService.maskExpression.slice(a.length-1,a.length));if(o>0){e.value=l?e.value.split(l).join(""):e.value;let n=e.value.split(s)[1];e.value=e.value.includes(s)?e.value+i.NUMBER_ZERO.repeat(o-n.length)+l:e.value+s+i.NUMBER_ZERO.repeat(o)+l,this._maskService.actualValue=e.value}}this._maskService.clearIfNotMatchFn()}this._isFocused.set(!1),this.onTouch()}onClick(t){if(!this._maskValue())return;let e=t.target,a=0,s=0;e!==null&&e.selectionStart!==null&&e.selectionStart===e.selectionEnd&&e.selectionStart>this._maskService.prefix.length&&t.keyCode!==38&&this._maskService.showMaskTyped&&!this.keepCharacterPositions()&&(this._maskService.maskIsShown=this._maskService.showMaskInInput(),e.setSelectionRange&&this._maskService.prefix+this._maskService.maskIsShown===e.value?(e.focus(),e.setSelectionRange(a,s)):e.selectionStart>this._maskService.actualValue.length&&e.setSelectionRange(this._maskService.actualValue.length,this._maskService.actualValue.length));let l=e&&(e.value===this._maskService.prefix?this._maskService.prefix+this._maskService.maskIsShown:e.value);if(e&&e.value!==l&&(e.value=l),e&&e.type!=="number"&&(e.selectionStart||e.selectionEnd)<=this._maskService.prefix.length){let o=this._maskService.maskExpression.match(new RegExp(`^[${this._maskService.specialCharacters.map(n=>`\\${n}`).join("")}]+`))?.[0].length||0;e.selectionStart=this._maskService.prefix.length+o;return}e&&e.selectionEnd>this._getActualInputLength()&&(e.selectionEnd=this._getActualInputLength())}onKeyDown(t){if(!this._maskValue())return;if(this._isComposing()){t.key==="Enter"&&this.onCompositionEnd(t);return}this._code.set(t.code?t.code:t.key);let e=t.target;if(this._inputValue.set(e.value),this._setMask(),e.type!=="number"){if(t.key===i.ARROW_UP&&t.preventDefault(),t.key===i.ARROW_LEFT||t.key===i.BACKSPACE||t.key===i.DELETE){if(t.key===i.BACKSPACE&&e.value.length===0&&(e.selectionStart=e.selectionEnd),t.key===i.BACKSPACE&&e.selectionStart!==0){let s=this.prefix().length,l=this.specialCharacters().length?this.specialCharacters():this._config.specialCharacters;if(s>1&&e.selectionStart<=s)e.setSelectionRange(s,e.selectionEnd);else if(this._inputValue().length!==e.selectionStart&&e.selectionStart!==1)for(;l.includes((this._inputValue()[e.selectionStart-1]??i.EMPTY_STRING).toString())&&(s>=1&&e.selectionStart>s||s===0);)e.setSelectionRange(e.selectionStart-1,e.selectionEnd)}this.checkSelectionOnDeletion(e),this._maskService.prefix.length&&e.selectionStart<=this._maskService.prefix.length&&e.selectionEnd<=this._maskService.prefix.length&&t.preventDefault();let a=e.selectionStart;t.key===i.BACKSPACE&&!e.readOnly&&a===0&&e.selectionEnd===e.value.length&&e.value.length!==0&&(this._position.set(this._maskService.prefix?this._maskService.prefix.length:0),this._maskService.applyMask(this._maskService.prefix,this._maskService.maskExpression,this._position()))}this.suffix()&&this.suffix().length>1&&this._inputValue().length-this.suffix().length<e.selectionStart?e.setSelectionRange(this._inputValue().length-this.suffix().length,this._inputValue().length):(t.code==="KeyA"&&t.ctrlKey||t.code==="KeyA"&&t.metaKey)&&(e.setSelectionRange(0,this._getActualInputLength()),t.preventDefault()),this._maskService.selStart=e.selectionStart,this._maskService.selEnd=e.selectionEnd}}writeValue(t){return ie(this,null,function*(){let e=t,a=this.inputTransformFn();if(typeof e=="object"&&e!==null&&"value"in e&&("disable"in e&&this.setDisabledState(!!e.disable),e=e.value),e!==null&&(e=a?a(e):e),typeof e=="string"||typeof e=="number"||e===null||typeof e>"u"){(e===null||typeof e>"u"||e==="")&&(this._maskService.currentValue="",this._maskService.previousValue="");let s=e;if(typeof s=="number"||this._maskValue().startsWith(i.SEPARATOR)){s=String(s);let l=this._maskService.currentLocaleDecimalMarker();Array.isArray(this._maskService.decimalMarker)||(s=this._maskService.decimalMarker!==l?s.replace(l,this._maskService.decimalMarker):s),this._maskService.leadZero&&s&&this.mask()&&this.dropSpecialCharacters()!==!1&&(s=this._maskService._checkPrecision(this._maskService.maskExpression,s)),(this._maskService.decimalMarker===i.COMMA||Array.isArray(this._maskService.decimalMarker)&&this._maskService.thousandSeparator===i.DOT)&&(s=s.toString().replace(i.DOT,i.COMMA)),this.mask()?.startsWith(i.SEPARATOR)&&this.leadZero()&&requestAnimationFrame(()=>{this._maskService.applyMask(s?.toString()??"",this._maskService.maskExpression)}),this._maskService.isNumberValue=!0}(typeof s!="string"||e===null||typeof e>"u")&&(s=""),this._inputValue.set(s),this._setMask(),s&&this._maskService.maskExpression||this._maskService.maskExpression&&(this._maskService.prefix||this._maskService.showMaskTyped)?(typeof a!="function"&&(this._maskService.writingValue=!0),this._maskService.formElementProperty=["value",this._maskService.applyMask(s,this._maskService.maskExpression)],typeof a!="function"&&(this._maskService.writingValue=!1)):this._maskService.formElementProperty=["value",s],this._inputValue.set(s)}else console.warn("Ngx-mask writeValue work with string | number, your current value:",typeof e)})}registerOnChange(t){this._maskService.onChange=this.onChange=t}registerOnTouched(t){this.onTouch=t}_getActiveElement(t=this.document){let e=t?.activeElement?.shadowRoot;return e?.activeElement?this._getActiveElement(e):t.activeElement}checkSelectionOnDeletion(t){let e=this.prefix().length,a=this.suffix().length,s=this._inputValue().length;t.selectionStart=Math.min(Math.max(e,t.selectionStart),s-a),t.selectionEnd=Math.min(Math.max(e,t.selectionEnd),s-a)}setDisabledState(t){this._maskService.formElementProperty=["disabled",t]}_applyMask(){this._maskService.maskExpression=this._maskService._repeatPatternSymbols(this._maskValue()||""),this._maskService.formElementProperty=["value",this._maskService.applyMask(this._inputValue(),this._maskService.maskExpression)]}_validateTime(t){let e=this._maskValue().split(i.EMPTY_STRING).filter(a=>a!==":").length;return t&&(+(t[t.length-1]??-1)==0&&t.length<e||t.length<=e-2)?this._createValidationError(t):null}_getActualInputLength(){return this._maskService.actualValue.length||this._maskService.actualValue.length+this._maskService.prefix.length}_createValidationError(t){return{mask:{requiredMask:this._maskValue(),actualValue:t}}}_setMask(){this._maskExpressionArray().some(t=>{if(t.split(i.EMPTY_STRING).some(a=>this._maskService.specialCharacters.includes(a))&&this._inputValue()&&this._areAllCharactersInEachStringSame(this._maskExpressionArray())||t.includes(i.CURLY_BRACKETS_LEFT)){let a=this._maskService.removeMask(this._inputValue())?.length<=this._maskService.removeMask(t)?.length;if(a){let s=t.includes(i.CURLY_BRACKETS_LEFT)?this._maskService._repeatPatternSymbols(t):t;return this._maskValue.set(s),this._maskService.maskExpression=s,a}else{let s=this._maskExpressionArray()[this._maskExpressionArray().length-1]??i.EMPTY_STRING,l=s.includes(i.CURLY_BRACKETS_LEFT)?this._maskService._repeatPatternSymbols(s):s;this._maskValue.set(l),this._maskService.maskExpression=l}}else{let a=this._maskService.removeMask(t),s=this._maskService.removeMask(this._inputValue())?.split(i.EMPTY_STRING).every((l,o)=>{let n=a.charAt(o);return this._maskService._checkSymbolMask(l,n)});if(s||this._justPasted())return this._maskValue.set(t),this._maskService.maskExpression=t,s}})}_areAllCharactersInEachStringSame(t){let e=this._maskService.specialCharacters;function a(l){let o=new RegExp(`[${e.map(n=>`\\${n}`).join("")}]`,"g");return l.replace(o,"")}return t.map(a).every(l=>new Set(l).size===1)}static \u0275fac=function(e){return new(e||h)};static \u0275dir=ce({type:h,selectors:[["input","mask",""],["textarea","mask",""]],hostBindings:function(e,a){e&1&&oe("paste",function(){return a.onPaste()})("focus",function(l){return a.onFocus(l)})("ngModelChange",function(l){return a.onModelChange(l)})("input",function(l){return a.onInput(l)})("compositionstart",function(l){return a.onCompositionStart(l)})("compositionend",function(l){return a.onCompositionEnd(l)})("blur",function(l){return a.onBlur(l)})("click",function(l){return a.onClick(l)})("keydown",function(l){return a.onKeyDown(l)})},inputs:{mask:[1,"mask"],specialCharacters:[1,"specialCharacters"],patterns:[1,"patterns"],prefix:[1,"prefix"],suffix:[1,"suffix"],thousandSeparator:[1,"thousandSeparator"],decimalMarker:[1,"decimalMarker"],dropSpecialCharacters:[1,"dropSpecialCharacters"],hiddenInput:[1,"hiddenInput"],showMaskTyped:[1,"showMaskTyped"],placeHolderCharacter:[1,"placeHolderCharacter"],shownMaskExpression:[1,"shownMaskExpression"],clearIfNotMatch:[1,"clearIfNotMatch"],validation:[1,"validation"],separatorLimit:[1,"separatorLimit"],allowNegativeNumbers:[1,"allowNegativeNumbers"],leadZeroDateTime:[1,"leadZeroDateTime"],leadZero:[1,"leadZero"],triggerOnMaskChange:[1,"triggerOnMaskChange"],apm:[1,"apm"],inputTransformFn:[1,"inputTransformFn"],outputTransformFn:[1,"outputTransformFn"],keepCharacterPositions:[1,"keepCharacterPositions"],instantPrefix:[1,"instantPrefix"]},outputs:{maskFilled:"maskFilled"},exportAs:["mask","ngxMask"],features:[ue([{provide:pe,useExisting:h,multi:!0},{provide:me,useExisting:h,multi:!0},te]),re]})}return h})();export{Je as a,ct as b,ot as c,j as d,be as e,qe as f};
