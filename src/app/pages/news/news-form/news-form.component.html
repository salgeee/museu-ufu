<div class="news-form-container">
  <h1>{{isEditMode ? 'Editar' : 'Criar'}} Notícia</h1>

  <form [formGroup]="newsForm" (ngSubmit)="onSubmit()" class="news-form">
    <div class="form-section">
      <h2>Informações da Notícia</h2>
      <p class="section-description">
        Estas informações serão exibidas na lista de notícias e na página de detalhes.
      </p>

      <div class="form-label-row">
        <label for="title">Título*</label>
        <span class="form-error" *ngIf="newsForm.get('title')?.invalid && (newsForm.get('title')?.dirty || newsForm.get('title')?.touched)">
          <ng-container *ngIf="newsForm.get('title')?.hasError('required')">Obrigatório</ng-container>
          <ng-container *ngIf="newsForm.get('title')?.hasError('minlength')">Mín. 3 caracteres</ng-container>
        </span>
      </div>
      <mat-form-field appearance="outline" class="full-width rounded-input">
        <input matInput id="title" formControlName="title" required autocomplete="off">
      </mat-form-field>

      <div class="form-label-row">
        <label for="summary">Resumo*</label>
        <span class="form-error" *ngIf="newsForm.get('summary')?.invalid && (newsForm.get('summary')?.dirty || newsForm.get('summary')?.touched)">
          <ng-container *ngIf="newsForm.get('summary')?.hasError('required')">Obrigatório</ng-container>
          <ng-container *ngIf="newsForm.get('summary')?.hasError('minlength')">Mín. 10 caracteres</ng-container>
        </span>
      </div>
      <mat-form-field appearance="outline" class="full-width rounded-input">
        <textarea matInput id="summary" formControlName="summary" rows="3" required autocomplete="off"></textarea>
      </mat-form-field>

      <div class="form-label-row">
        <label for="category">Categoria*</label>
        <span class="form-error" *ngIf="newsForm.get('category')?.invalid && (newsForm.get('category')?.dirty || newsForm.get('category')?.touched)">
          <ng-container *ngIf="newsForm.get('category')?.hasError('required')">Obrigatório</ng-container>
        </span>
      </div>
      <mat-form-field appearance="outline" class="full-width rounded-input">
        <mat-select id="category" formControlName="category" required>
          <mat-option *ngFor="let category of categories" [value]="category">
            {{category}}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <div class="form-label-row">
        <label for="content">Conteúdo Completo*</label>
        <span class="form-error" *ngIf="newsForm.get('content')?.invalid && (newsForm.get('content')?.dirty || newsForm.get('content')?.touched)">
          <ng-container *ngIf="newsForm.get('content')?.hasError('required')">Obrigatório</ng-container>
          <ng-container *ngIf="newsForm.get('content')?.hasError('minlength')">Mín. 20 caracteres</ng-container>
        </span>
      </div>
      <mat-form-field appearance="outline" class="full-width rounded-input">
        <textarea matInput id="content" formControlName="content" rows="10" required autocomplete="off"></textarea>
      </mat-form-field>

      <div class="image-upload-section">
        <label>Imagem Principal</label>
        <div class="image-upload">
          <input type="file" accept="image/*" (change)="onMainImageChange($event)" #mainImageInput style="display: none">
          <button type="button" mat-stroked-button (click)="mainImageInput.click()">
            <mat-icon>upload</mat-icon>
            Escolher Imagem
          </button>
          <span *ngIf="mainImageFileName" class="file-name">{{mainImageFileName}}</span>
        </div>
      </div>
    </div>

    <div class="form-actions">
      <button type="button" mat-button (click)="cancel()">Cancelar</button>
      <button type="submit" mat-raised-button color="primary" [disabled]="!newsForm.valid">
        {{isEditMode ? 'Salvar' : 'Criar'}} Notícia
      </button>
    </div>
  </form>
</div>
